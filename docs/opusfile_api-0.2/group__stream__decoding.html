<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>opusfile: Decoding</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="opus_logo.svg"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">opusfile
   &#160;<span id="projectnumber">0.2</span>
   </div>
   <div id="projectbrief">Stand-alone decoder library for .opus files.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Decoding</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="member-group"></a>
Functions for decoding audio data</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrp226a9332d44ee54e9c863d78e0829f0d"></a>These functions retrieve actual decoded audio data from the stream.</p>
<p>The general functions, <a class="el" href="group__stream__decoding.html#ga963c917749335e29bb2b698c1cb20a10" title="Reads more samples from the stream.">op_read()</a> and <a class="el" href="group__stream__decoding.html#ga73493002d84a234f5e19b70f1dddbe2a" title="Reads more samples from the stream.">op_read_float()</a> return 16-bit or floating-point output, both using native endian ordering. The number of channels returned can change from link to link in a chained stream. There are special functions, <a class="el" href="group__stream__decoding.html#gaaca17ad3fd6430dc8fd43308149428eb" title="Reads more samples from the stream and downmixes to stereo, if necessary.">op_read_stereo()</a> and <a class="el" href="group__stream__decoding.html#ga9736f96563500c0978f56f0fd6bdad83" title="Reads more samples from the stream and downmixes to stereo, if necessary.">op_read_float_stereo()</a>, which always output two channels, to simplify applications which do not wish to handle multichannel audio. These downmix multichannel files to two channels, so they can always return samples in the same format for every link in a chained file.</p>
<p>If the rest of your audio processing chain can handle floating point, those routines should be preferred, as floating point output avoids introducing clipping and other issues which might be avoided entirely if, e.g., you scale down the volume at some other stage. However, if you intend to direct consume 16-bit samples, the conversion in <code>libopusfile</code> provides noise-shaping dithering API.</p>
<p><code>libopusfile</code> can also be configured at compile time to use the fixed-point <code>libopus</code> API. If so, the floating-point API may also be disabled. In that configuration, nothing in <code>libopusfile</code> will use any floating-point operations, to simplify support on devices without an adequate FPU.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>HTTPS streams may be be vulnerable to truncation attacks if you do not check the error return code from <a class="el" href="group__stream__decoding.html#ga73493002d84a234f5e19b70f1dddbe2a" title="Reads more samples from the stream.">op_read_float()</a> or its associated functions. If the remote peer does not close the connection gracefully (with a TLS "close notify" message), these functions will return OP_EREAD instead of 0 when they reach the end of the file. If you are reading from an &lt;https:&gt; URL (particularly if seeking is not supported), you should make sure to check for this error and warn the user appropriately. </dd></dl>
</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">OP_WARN_UNUSED_RESULT int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stream__decoding.html#ga963c917749335e29bb2b698c1cb20a10">op_read</a> (OggOpusFile *_of, opus_int16 *_pcm, int _buf_size, int *_li) OP_ARG_NONNULL(1)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads more samples from the stream.  <a href="#ga963c917749335e29bb2b698c1cb20a10"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">OP_WARN_UNUSED_RESULT int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stream__decoding.html#ga73493002d84a234f5e19b70f1dddbe2a">op_read_float</a> (OggOpusFile *_of, float *_pcm, int _buf_size, int *_li) OP_ARG_NONNULL(1)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads more samples from the stream.  <a href="#ga73493002d84a234f5e19b70f1dddbe2a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">OP_WARN_UNUSED_RESULT int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stream__decoding.html#gaaca17ad3fd6430dc8fd43308149428eb">op_read_stereo</a> (OggOpusFile *_of, opus_int16 *_pcm, int _buf_size) OP_ARG_NONNULL(1)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads more samples from the stream and downmixes to stereo, if necessary.  <a href="#gaaca17ad3fd6430dc8fd43308149428eb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">OP_WARN_UNUSED_RESULT int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stream__decoding.html#ga9736f96563500c0978f56f0fd6bdad83">op_read_float_stereo</a> (OggOpusFile *_of, float *_pcm, int _buf_size) OP_ARG_NONNULL(1)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads more samples from the stream and downmixes to stereo, if necessary.  <a href="#ga9736f96563500c0978f56f0fd6bdad83"></a><br/></td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga963c917749335e29bb2b698c1cb20a10"></a><!-- doxytag: member="opusfile.h::op_read" ref="ga963c917749335e29bb2b698c1cb20a10" args="(OggOpusFile *_of, opus_int16 *_pcm, int _buf_size, int *_li) OP_ARG_NONNULL(1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OP_WARN_UNUSED_RESULT int <a class="el" href="group__stream__decoding.html#ga963c917749335e29bb2b698c1cb20a10">op_read</a> </td>
          <td>(</td>
          <td class="paramtype">OggOpusFile *&#160;</td>
          <td class="paramname"><em>_of</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">opus_int16 *&#160;</td>
          <td class="paramname"><em>_pcm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_buf_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>_li</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reads more samples from the stream. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>Although <em>_buf_size</em> must indicate the total number of values that can be stored in <em>_pcm</em>, the return value is the number of samples <em>per channel</em>. This is done because <ol>
<li>
The channel count cannot be known a prior (reading more samples might advance us into the next link, with a different channel count), so <em>_buf_size</em> cannot also be in units of samples per channel, </li>
<li>
Returning the samples per channel matches the <code>libopus</code> API as closely as we're able, </li>
<li>
Returning the total number of values instead of samples per channel would mean the caller would need a division to compute the samples per channel, and might worry about the possibility of getting back samples for some channels and not others, and </li>
<li>
This approach is relatively fool-proof: if an application passes too small a value to <em>_buf_size</em>, they will simply get fewer samples back, and if they assume the return value is the total number of values, then they will simply read too few (rather than reading too many and going off the end of the buffer). </li>
</ol>
</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">_of</td><td>The <code>OggOpusFile</code> from which to read. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_pcm</td><td>A buffer in which to store the output PCM samples, as signed native-endian 16-bit values with a nominal range of <code>[-32768,32767)</code>. Multiple channels are interleaved using the <a href="http://www.xiph.org/vorbis/doc/Vorbis_I_spec.html#x1-800004.3.9">Vorbis channel ordering</a>. This must have room for at least <em>_buf_size</em> values. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">_buf_size</td><td>The number of values that can be stored in <em>_pcm</em>. It is reccommended that this be large enough for at least 120 ms of data at 48 kHz per channel (5760 values per channel). Smaller buffers will simply return less data, possibly consuming more memory to buffer the data internally. <code>libopusfile</code> may return less data than requested. If so, there is no guarantee that the remaining data in <em>_pcm</em> will be unmodified. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_li</td><td>The index of the link this data was decoded from. You may pass <code>NULL</code> if you do not need this information. If this function fails (returning a negative value), this parameter is left unset. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of samples read per channel on success, or a negative value on failure. The channel count can be retrieved on success by calling <code>op_head(_of,*_li)</code>. The number of samples returned may be 0 if the buffer was too small to store even a single sample for all channels, or if end-of-file was reached. The list of possible failure codes follows. Most of them can only be returned by unseekable, chained streams that encounter a new link. </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga2ac03d35986d3505305d468dd2138b72" title="There was a hole in the page sequence numbers (e.g., a page was corrupt or missing).">OP_HOLE</a></td><td>There was a hole in the data, and some samples may have been skipped. Call this function again to continue decoding past the hole. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga3ad48a4f99b1bed72acec552296dfc08" title="An underlying read, seek, or tell operation failed when it should have succeeded.">OP_EREAD</a></td><td>An underlying read operation failed. This may signal a truncation attack from an &lt;https:&gt; source. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga2ddb887c0bb55c74ea6be391fabcba59" title="A NULL pointer was passed where one was unexpected, or an internal memory allocation failed...">OP_EFAULT</a></td><td>An internal memory allocation failed. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaeea27378f826033ca23584d8403665d3" title="The stream used a feature that is not implemented, such as an unsupported channel family...">OP_EIMPL</a></td><td>An unseekable stream encountered a new link that used a feature that is not implemented, such as an unsupported channel family. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gae0879acafe9cc0ab72462d291fdb6fb6" title="One or more parameters to a function were invalid.">OP_EINVAL</a></td><td>The stream was only partially open. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gafca3ae244d24e10b2851c77379453220" title="A purported Ogg Opus stream did not begin with an Ogg page, a purported header packet did not start w...">OP_ENOTFORMAT</a></td><td>An unseekable stream encountered a new link that did not have any logical Opus streams in it. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga534f1b45c8733a2928434e482b38869f" title="A required header packet was not properly formatted, contained illegal values, or was missing altoget...">OP_EBADHEADER</a></td><td>An unseekable stream encountered a new link with a required header packet that was not properly formatted, contained illegal values, or was missing altogether. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaa9ae4494f623f3c0609f0b4bd99b8f32" title="The ID header contained an unrecognized version number.">OP_EVERSION</a></td><td>An unseekable stream encountered a new link with an ID header that contained an unrecognized version number. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaa3fa0a3e6facc4f47924271e65bb21ff" title="An audio packet failed to decode properly.">OP_EBADPACKET</a></td><td>Failed to properly decode the next packet. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaf7b58a439a471366e9eb5b8f2a8cd041" title="We failed to find data we had seen before, or the bitstream structure was sufficiently malformed that...">OP_EBADLINK</a></td><td>We failed to find data we had seen before. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaf82657fc888f1dcf2e0d8f066b8a6cc7" title="The first or last granule position of a link failed basic validity checks.">OP_EBADTIMESTAMP</a></td><td>An unseekable stream encountered a new link with a starting timestamp that failed basic validity checks. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga73493002d84a234f5e19b70f1dddbe2a"></a><!-- doxytag: member="opusfile.h::op_read_float" ref="ga73493002d84a234f5e19b70f1dddbe2a" args="(OggOpusFile *_of, float *_pcm, int _buf_size, int *_li) OP_ARG_NONNULL(1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OP_WARN_UNUSED_RESULT int <a class="el" href="group__stream__decoding.html#ga73493002d84a234f5e19b70f1dddbe2a">op_read_float</a> </td>
          <td>(</td>
          <td class="paramtype">OggOpusFile *&#160;</td>
          <td class="paramname"><em>_of</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>_pcm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_buf_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>_li</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reads more samples from the stream. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>Although <em>_buf_size</em> must indicate the total number of values that can be stored in <em>_pcm</em>, the return value is the number of samples <em>per channel</em>. <ol>
<li>
The channel count cannot be known a prior (reading more samples might advance us into the next link, with a different channel count), so <em>_buf_size</em> cannot also be in units of samples per channel, </li>
<li>
Returning the samples per channel matches the <code>libopus</code> API as closely as we're able, </li>
<li>
Returning the total number of values instead of samples per channel would mean the caller would need a division to compute the samples per channel, and might worry about the possibility of getting back samples for some channels and not others, and </li>
<li>
This approach is relatively fool-proof: if an application passes too small a value to <em>_buf_size</em>, they will simply get fewer samples back, and if they assume the return value is the total number of values, then they will simply read too few (rather than reading too many and going off the end of the buffer). </li>
</ol>
</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">_of</td><td>The <code>OggOpusFile</code> from which to read. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_pcm</td><td>A buffer in which to store the output PCM samples as signed floats with a nominal range of <code>[-1.0,1.0]</code>. Multiple channels are interleaved using the <a href="http://www.xiph.org/vorbis/doc/Vorbis_I_spec.html#x1-800004.3.9">Vorbis channel ordering</a>. This must have room for at least <em>_buf_size</em> floats. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">_buf_size</td><td>The number of floats that can be stored in <em>_pcm</em>. It is reccommended that this be large enough for at least 120 ms of data at 48 kHz per channel (5760 samples per channel). Smaller buffers will simply return less data, possibly consuming more memory to buffer the data internally. If less than <em>_buf_size</em> values are returned, <code>libopusfile</code> makes no guarantee that the remaining data in <em>_pcm</em> will be unmodified. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_li</td><td>The index of the link this data was decoded from. You may pass <code>NULL</code> if you do not need this information. If this function fails (returning a negative value), this parameter is left unset. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of samples read per channel on success, or a negative value on failure. The channel count can be retrieved on success by calling <code>op_head(_of,*_li)</code>. The number of samples returned may be 0 if the buffer was too small to store even a single sample for all channels, or if end-of-file was reached. The list of possible failure codes follows. Most of them can only be returned by unseekable, chained streams that encounter a new link. </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga2ac03d35986d3505305d468dd2138b72" title="There was a hole in the page sequence numbers (e.g., a page was corrupt or missing).">OP_HOLE</a></td><td>There was a hole in the data, and some samples may have been skipped. Call this function again to continue decoding past the hole. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga3ad48a4f99b1bed72acec552296dfc08" title="An underlying read, seek, or tell operation failed when it should have succeeded.">OP_EREAD</a></td><td>An underlying read operation failed. This may signal a truncation attack from an &lt;https:&gt; source. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga2ddb887c0bb55c74ea6be391fabcba59" title="A NULL pointer was passed where one was unexpected, or an internal memory allocation failed...">OP_EFAULT</a></td><td>An internal memory allocation failed. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaeea27378f826033ca23584d8403665d3" title="The stream used a feature that is not implemented, such as an unsupported channel family...">OP_EIMPL</a></td><td>An unseekable stream encountered a new link that used a feature that is not implemented, such as an unsupported channel family. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gae0879acafe9cc0ab72462d291fdb6fb6" title="One or more parameters to a function were invalid.">OP_EINVAL</a></td><td>The stream was only partially open. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gafca3ae244d24e10b2851c77379453220" title="A purported Ogg Opus stream did not begin with an Ogg page, a purported header packet did not start w...">OP_ENOTFORMAT</a></td><td>An unseekable stream encountered a new link that did not have any logical Opus streams in it. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga534f1b45c8733a2928434e482b38869f" title="A required header packet was not properly formatted, contained illegal values, or was missing altoget...">OP_EBADHEADER</a></td><td>An unseekable stream encountered a new link with a required header packet that was not properly formatted, contained illegal values, or was missing altogether. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaa9ae4494f623f3c0609f0b4bd99b8f32" title="The ID header contained an unrecognized version number.">OP_EVERSION</a></td><td>An unseekable stream encountered a new link with an ID header that contained an unrecognized version number. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaa3fa0a3e6facc4f47924271e65bb21ff" title="An audio packet failed to decode properly.">OP_EBADPACKET</a></td><td>Failed to properly decode the next packet. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaf7b58a439a471366e9eb5b8f2a8cd041" title="We failed to find data we had seen before, or the bitstream structure was sufficiently malformed that...">OP_EBADLINK</a></td><td>We failed to find data we had seen before. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaf82657fc888f1dcf2e0d8f066b8a6cc7" title="The first or last granule position of a link failed basic validity checks.">OP_EBADTIMESTAMP</a></td><td>An unseekable stream encountered a new link with a starting timestamp that failed basic validity checks. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gaaca17ad3fd6430dc8fd43308149428eb"></a><!-- doxytag: member="opusfile.h::op_read_stereo" ref="gaaca17ad3fd6430dc8fd43308149428eb" args="(OggOpusFile *_of, opus_int16 *_pcm, int _buf_size) OP_ARG_NONNULL(1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OP_WARN_UNUSED_RESULT int <a class="el" href="group__stream__decoding.html#gaaca17ad3fd6430dc8fd43308149428eb">op_read_stereo</a> </td>
          <td>(</td>
          <td class="paramtype">OggOpusFile *&#160;</td>
          <td class="paramname"><em>_of</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">opus_int16 *&#160;</td>
          <td class="paramname"><em>_pcm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_buf_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reads more samples from the stream and downmixes to stereo, if necessary. </p>
<p>This function is intended for simple players that want a uniform output format, even if the channel count changes between links in a chained stream. </p>
<dl class="note"><dt><b>Note:</b></dt><dd><em>_buf_size</em> indicates the total number of values that can be stored in <em>_pcm</em>, while the return value is the number of samples <em>per channel</em>, even though the channel count is known, for consistency with <a class="el" href="group__stream__decoding.html#ga963c917749335e29bb2b698c1cb20a10" title="Reads more samples from the stream.">op_read()</a>. </dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">_of</td><td>The <code>OggOpusFile</code> from which to read. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_pcm</td><td>A buffer in which to store the output PCM samples, as signed native-endian 16-bit values with a nominal range of <code>[-32768,32767)</code>. The left and right channels are interleaved in the buffer. This must have room for at least <em>_buf_size</em> values. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">_buf_size</td><td>The number of values that can be stored in <em>_pcm</em>. It is reccommended that this be large enough for at least 120 ms of data at 48 kHz per channel (11520 values total). Smaller buffers will simply return less data, possibly consuming more memory to buffer the data internally. If less than <em>_buf_size</em> values are returned, <code>libopusfile</code> makes no guarantee that the remaining data in <em>_pcm</em> will be unmodified. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of samples read per channel on success, or a negative value on failure. The number of samples returned may be 0 if the buffer was too small to store even a single sample for both channels, or if end-of-file was reached. The list of possible failure codes follows. Most of them can only be returned by unseekable, chained streams that encounter a new link. </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga2ac03d35986d3505305d468dd2138b72" title="There was a hole in the page sequence numbers (e.g., a page was corrupt or missing).">OP_HOLE</a></td><td>There was a hole in the data, and some samples may have been skipped. Call this function again to continue decoding past the hole. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga3ad48a4f99b1bed72acec552296dfc08" title="An underlying read, seek, or tell operation failed when it should have succeeded.">OP_EREAD</a></td><td>An underlying read operation failed. This may signal a truncation attack from an &lt;https:&gt; source. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga2ddb887c0bb55c74ea6be391fabcba59" title="A NULL pointer was passed where one was unexpected, or an internal memory allocation failed...">OP_EFAULT</a></td><td>An internal memory allocation failed. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaeea27378f826033ca23584d8403665d3" title="The stream used a feature that is not implemented, such as an unsupported channel family...">OP_EIMPL</a></td><td>An unseekable stream encountered a new link that used a feature that is not implemented, such as an unsupported channel family. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gae0879acafe9cc0ab72462d291fdb6fb6" title="One or more parameters to a function were invalid.">OP_EINVAL</a></td><td>The stream was only partially open. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gafca3ae244d24e10b2851c77379453220" title="A purported Ogg Opus stream did not begin with an Ogg page, a purported header packet did not start w...">OP_ENOTFORMAT</a></td><td>An unseekable stream encountered a new link that did not have any logical Opus streams in it. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga534f1b45c8733a2928434e482b38869f" title="A required header packet was not properly formatted, contained illegal values, or was missing altoget...">OP_EBADHEADER</a></td><td>An unseekable stream encountered a new link with a required header packet that was not properly formatted, contained illegal values, or was missing altogether. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaa9ae4494f623f3c0609f0b4bd99b8f32" title="The ID header contained an unrecognized version number.">OP_EVERSION</a></td><td>An unseekable stream encountered a new link with an ID header that contained an unrecognized version number. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaa3fa0a3e6facc4f47924271e65bb21ff" title="An audio packet failed to decode properly.">OP_EBADPACKET</a></td><td>Failed to properly decode the next packet. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaf7b58a439a471366e9eb5b8f2a8cd041" title="We failed to find data we had seen before, or the bitstream structure was sufficiently malformed that...">OP_EBADLINK</a></td><td>We failed to find data we had seen before. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaf82657fc888f1dcf2e0d8f066b8a6cc7" title="The first or last granule position of a link failed basic validity checks.">OP_EBADTIMESTAMP</a></td><td>An unseekable stream encountered a new link with a starting timestamp that failed basic validity checks. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga9736f96563500c0978f56f0fd6bdad83"></a><!-- doxytag: member="opusfile.h::op_read_float_stereo" ref="ga9736f96563500c0978f56f0fd6bdad83" args="(OggOpusFile *_of, float *_pcm, int _buf_size) OP_ARG_NONNULL(1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OP_WARN_UNUSED_RESULT int <a class="el" href="group__stream__decoding.html#ga9736f96563500c0978f56f0fd6bdad83">op_read_float_stereo</a> </td>
          <td>(</td>
          <td class="paramtype">OggOpusFile *&#160;</td>
          <td class="paramname"><em>_of</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>_pcm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_buf_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reads more samples from the stream and downmixes to stereo, if necessary. </p>
<p>This function is intended for simple players that want a uniform output format, even if the channel count changes between links in a chained stream. </p>
<dl class="note"><dt><b>Note:</b></dt><dd><em>_buf_size</em> indicates the total number of values that can be stored in <em>_pcm</em>, while the return value is the number of samples <em>per channel</em>, even though the channel count is known, for consistency with <a class="el" href="group__stream__decoding.html#ga73493002d84a234f5e19b70f1dddbe2a" title="Reads more samples from the stream.">op_read_float()</a>. </dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">_of</td><td>The <code>OggOpusFile</code> from which to read. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_pcm</td><td>A buffer in which to store the output PCM samples, as signed floats with a nominal range of <code>[-1.0,1.0]</code>. The left and right channels are interleaved in the buffer. This must have room for at least <em>_buf_size</em> values. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">_buf_size</td><td>The number of values that can be stored in <em>_pcm</em>. It is reccommended that this be large enough for at least 120 ms of data at 48 kHz per channel (11520 values total). Smaller buffers will simply return less data, possibly consuming more memory to buffer the data internally. If less than <em>_buf_size</em> values are returned, <code>libopusfile</code> makes no guarantee that the remaining data in <em>_pcm</em> will be unmodified. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of samples read per channel on success, or a negative value on failure. The number of samples returned may be 0 if the buffer was too small to store even a single sample for both channels, or if end-of-file was reached. The list of possible failure codes follows. Most of them can only be returned by unseekable, chained streams that encounter a new link. </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga2ac03d35986d3505305d468dd2138b72" title="There was a hole in the page sequence numbers (e.g., a page was corrupt or missing).">OP_HOLE</a></td><td>There was a hole in the data, and some samples may have been skipped. Call this function again to continue decoding past the hole. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga3ad48a4f99b1bed72acec552296dfc08" title="An underlying read, seek, or tell operation failed when it should have succeeded.">OP_EREAD</a></td><td>An underlying read operation failed. This may signal a truncation attack from an &lt;https:&gt; source. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga2ddb887c0bb55c74ea6be391fabcba59" title="A NULL pointer was passed where one was unexpected, or an internal memory allocation failed...">OP_EFAULT</a></td><td>An internal memory allocation failed. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaeea27378f826033ca23584d8403665d3" title="The stream used a feature that is not implemented, such as an unsupported channel family...">OP_EIMPL</a></td><td>An unseekable stream encountered a new link that used a feature that is not implemented, such as an unsupported channel family. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gae0879acafe9cc0ab72462d291fdb6fb6" title="One or more parameters to a function were invalid.">OP_EINVAL</a></td><td>The stream was only partially open. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gafca3ae244d24e10b2851c77379453220" title="A purported Ogg Opus stream did not begin with an Ogg page, a purported header packet did not start w...">OP_ENOTFORMAT</a></td><td>An unseekable stream encountered a new link that that did not have any logical Opus streams in it. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#ga534f1b45c8733a2928434e482b38869f" title="A required header packet was not properly formatted, contained illegal values, or was missing altoget...">OP_EBADHEADER</a></td><td>An unseekable stream encountered a new link with a required header packet that was not properly formatted, contained illegal values, or was missing altogether. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaa9ae4494f623f3c0609f0b4bd99b8f32" title="The ID header contained an unrecognized version number.">OP_EVERSION</a></td><td>An unseekable stream encountered a new link with an ID header that contained an unrecognized version number. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaa3fa0a3e6facc4f47924271e65bb21ff" title="An audio packet failed to decode properly.">OP_EBADPACKET</a></td><td>Failed to properly decode the next packet. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaf7b58a439a471366e9eb5b8f2a8cd041" title="We failed to find data we had seen before, or the bitstream structure was sufficiently malformed that...">OP_EBADLINK</a></td><td>We failed to find data we had seen before. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error__codes.html#gaf82657fc888f1dcf2e0d8f066b8a6cc7" title="The first or last granule position of a link failed basic validity checks.">OP_EBADTIMESTAMP</a></td><td>An unseekable stream encountered a new link with a starting timestamp that failed basic validity checks. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 30 2013 08:56:10 for opusfile by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
